<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      lang="ko"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>팀 정보</title>
</head>

<th:block layout:fragment="script">
    <script src="/js/calendar.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const editButton = document.getElementById("editButton");
            const saveButton = document.getElementById("saveButton");
            const cancelButton = document.getElementById("cancelButton");

            const teamNameText = document.getElementById("teamNameText");
            const teamDetailText = document.getElementById("teamDetailText");
            const regionText = document.getElementById("regionText");
            const ageRangeText = document.getElementById("ageRangeText");

            const teamNameInput = document.getElementById("teamNameInput");
            const teamDetailInput = document.getElementById("teamDetailInput");
            const regionSelect = document.getElementById("regionSelect");
            const ageRangeSelect = document.getElementById("ageRangeSelect");

            // "팀 정보 수정" 버튼 클릭 시 입력 필드 활성화
            editButton.addEventListener("click", function () {
                teamNameText.classList.add("hidden");
                teamDetailText.classList.add("hidden");
                regionText.classList.add("hidden");
                ageRangeText.classList.add("hidden");

                teamNameInput.classList.remove("hidden");
                teamDetailInput.classList.remove("hidden");
                regionSelect.classList.remove("hidden");
                ageRangeSelect.classList.remove("hidden");

                editButton.classList.add("hidden");
                saveButton.classList.remove("hidden");
                cancelButton.classList.remove("hidden");
            });

            // "취소" 버튼 클릭 시 원래 상태로 복구
            cancelButton.addEventListener("click", function () {
                teamNameText.classList.remove("hidden");
                teamDetailText.classList.remove("hidden");
                regionText.classList.remove("hidden");
                ageRangeText.classList.remove("hidden");

                teamNameInput.classList.add("hidden");
                teamDetailInput.classList.add("hidden");
                regionSelect.classList.add("hidden");
                ageRangeSelect.classList.add("hidden");

                editButton.classList.remove("hidden");
                saveButton.classList.add("hidden");
                cancelButton.classList.add("hidden");
            });
        });
    </script>
</th:block>

<div layout:fragment="content" class="max-w-4xl mx-auto bg-white rounded-lg shadow-sm p-8" th:object="${teamInfoDto}">
    <form id="teamEditForm" th:action="@{'/teams/' + ${teamInfoDto.teamId}}" method="post">
        <div class="flex items-center justify-between mb-6">
            <div class="flex items-center space-x-6">
                <img th:src="${teamInfoDto.logoUrl}" alt="팀 로고" class="w-32 h-32 rounded-lg shadow-sm"/>
                <div>
                    <h2 id="teamNameText" class="text-2xl font-bold mb-2" th:text="${teamInfoDto.teamName}"></h2>
                    <input id="teamNameInput" name="teamName" type="text" th:value="${teamInfoDto.teamName}"
                           class="hidden border p-2 rounded-md w-full"/>

                    <div class="text-gray-600">
                        <span class="mr-4" th:text="'팀원 ' + ${teamInfoDto.memberNum} + '명'"></span>
                        <span class="mr-4"
                              th:text="${teamInfoDto.wins} + '승 ' + ${teamInfoDto.draws}+'무 ' + ${teamInfoDto.loses} + '패'"></span>
                        <span th:text="'승률 ' + ${teamInfoDto.winRate} + '%'"></span>
                    </div>
                    <div class="text-gray-600">
                        <span id="regionText" class="mr-4"
                              th:text="'지역 : ' + ${teamInfoDto.region.getRegionName}"></span>
                        <select id="regionSelect" name="region" class="hidden border p-2 pr-8 mr-2 rounded-md">
                            <option th:each="re : ${regions}"
                                    th:value="${re.name()}"
                                    th:text="${re.getRegionName}"
                                    th:selected="${re.getRegionName == teamInfoDto.region.getRegionName}">
                            </option>
                        </select>

                        <span id="ageRangeText" class="mr-4"
                              th:text="'나이대 : ' + ${teamInfoDto.ageRange.getRange}"></span>
                        <select id="ageRangeSelect" name="ageRange" class="hidden border p-2 pr-8 mr-2 rounded-md">
                            <option th:each="age : ${ageRanges}"
                                    th:value="${age.name()}"
                                    th:text="${age.getRange}"
                                    th:selected="${age.getRange == teamInfoDto.ageRange.getRange}">
                            </option>
                        </select>
                    </div>
                </div>

                <div class="flex flex-col space-y-2 pl-10">
                    <button type="button" id="editButton"
                            class="text-sm px-4 py-2 bg-custom text-white rounded-lg hover:bg-custom/90">팀 정보 수정
                    </button>
                    <button type="submit" id="saveButton"
                            class="hidden text-sm px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600">저장
                    </button>
                    <button type="button" id="cancelButton"
                            class="hidden text-sm px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600">취소
                    </button>
                    <button class="text-sm px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">팀 삭제</button>
                </div>
            </div>
        </div>

        <h3 class="text-lg font-semibold mb-4">팀 소개</h3>
        <p id="teamDetailText" class="text-gray-600 leading-relaxed"
           th:text="${teamInfoDto.teamDetail.isEmpty() ? '(공 백)' : teamInfoDto.teamDetail}"></p>
        <textarea id="teamDetailInput" name="teamDetail"
                  class="hidden border p-2 rounded-md w-full" rows="3">[[${teamInfoDto.teamDetail}]]</textarea>
    </form>

    <div class="prose max-w-none mb-8 pt-8">
        <h3 class="text-lg font-semibold mb-4">팀 일정</h3>
        <div class="bg-white rounded-lg overflow-hidden max-w-xl mx-auto">
            <div class="flex items-center justify-between p-4 bg-gray-50">
                <button id="prevMonth" class="text-gray-600 hover:text-custom">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <h4 id="calendarMonth" class="font-semibold">2024년 3월</h4>
                <button id="nextMonth" class="text-gray-600 hover:text-custom">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
            <div class="grid grid-cols-7 gap-px bg-gray-200">
                <div class="bg-gray-50 p-2 text-center text-sm font-medium text-gray-500">일</div>
                <div class="bg-gray-50 p-2 text-center text-sm font-medium text-gray-500">월</div>
                <div class="bg-gray-50 p-2 text-center text-sm font-medium text-gray-500">화</div>
                <div class="bg-gray-50 p-2 text-center text-sm font-medium text-gray-500">수</div>
                <div class="bg-gray-50 p-2 text-center text-sm font-medium text-gray-500">목</div>
                <div class="bg-gray-50 p-2 text-center text-sm font-medium text-gray-500">금</div>
                <div class="bg-gray-50 p-2 text-center text-sm font-medium text-gray-500">토</div>
            </div>

            <div id="calendarDays" class="grid grid-cols-7 gap-px bg-gray-200">
                <!-- JavaScript가 날짜 추가 -->
            </div>
        </div>
    </div>

</div>


